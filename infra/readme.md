# Infra projects

Infra contains several services which provide a basic infrastructure for other services to build on. 

## Setup

Start the compose. 
On the first startup, LLDAP will prompt you to create the first user. 

## Services

### Dashy

Dashy is a landing page that organizes links to other services. This allows you record and link to all of the services that are provided by compose-nas. 

### Caddy

Caddy provides routing to backend services as well as SSL encryption and connecting to Authelia for authentication. New services that present web frontends should connect to the `compose-nas` network and be added to one of the Caddyfiles. `Caddyfile` exposes services on port 443 while `InternalCaddyfile` exposes service on port 8443, which allows the router to expose some services publicly while leaving other services available on the internal network. 

### LLDAP

LLDAP is a simplified LDAP server. 

### Authelia

Authelia provides OIDC and proxy authentication and authorization. It supports LLDAP as a backend for reading users. 

### Stalwart Mail Server

Stalwart mail server provides an SMTP server and an IMAP server for emails related to the NAS. Connections to most public SMTP services are restricted, so setting up a local instance is faster. This private SMTP instance will only be able to deliver mail to its own IMAP server though, so you will need to configure another server or client to read emails from the private mail server.  
TODO: Configure GMail to read from the private IMAP server.  
A pre-generated config is checked in, which connects to the LLDAP instance, but the configuration can be re-generated by executing `docker exec -it mail /bin/sh /usr/local/bin/configure.sh` and then updating the checked in file.